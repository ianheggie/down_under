#!/usr/bin/env bash
cd "$(dirname "$0")/.."

if [ $# -lt 1 ]; then
    echo "Usage: $(basename $0) <region> [ssh-options]"
    echo "Regions: au, usa, eu"
    exit 1
fi

REGION="$1"
shift

if [[ ! "au usa eu" =~ $REGION ]]; then
    echo "Error: Region must be one of: au, usa, eu"
    exit 1
fi

if [ -z "$PROXY_DOMAIN" ]; then
    echo "Error: PROXY_DOMAIN environment variable not set"
    exit 1
fi

source .ports
HOST="$REGION-proxy.$PROXY_DOMAIN"

exec ssh -p "$SSH_PORT" "root@$HOST" "$@"
